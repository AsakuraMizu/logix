diff --git a/dist/tinro.es.js b/dist/tinro.es.js
new file mode 100644
index 0000000000000000000000000000000000000000..92637888a4e6d89fe02c0328dc49d7735c585f78
--- /dev/null
+++ b/dist/tinro.es.js
@@ -0,0 +1 @@
+import{SvelteComponent as at,check_outros as rt,create_slot as nt,detach as st,empty as it,get_all_dirty_from_scope as ct,get_slot_changes as lt,group_outros as ot,init as ut,insert as ht,safe_not_equal as ft,transition_in as w,transition_out as R,update_slot_base as mt}from"svelte/internal";import{getContext as I}from"svelte";import{writable as K}from"svelte/store";import{hasContext as J,getContext as F,setContext as V,onMount as X,tick as $}from"svelte";import{writable as tt}from"svelte/store";function y(e,n=!1){return e=e.slice(e.startsWith("/#")?2:0,e.endsWith("/*")?-2:void 0),e.startsWith("/")||(e="/"+e),e==="/"&&(e=""),n&&!e.endsWith("/")&&(e+="/"),e}function v(e,n){e=y(e,!0),n=y(n,!0);let r=[],a={},t=!0,i=e.split("/").map(c=>c.startsWith(":")?(r.push(c.slice(1)),"([^\\/]+)"):c).join("\\/"),s=n.match(new RegExp(`^${i}$`));return s||(t=!1,s=n.match(new RegExp(`^${i}`))),s?(r.forEach((c,f)=>a[c]=s[f+1]),{exact:t,params:a,part:s[0].slice(0,-1)}):null}function C(e,n,r){if(r==="")return e;if(r[0]==="/")return r;let a=s=>s.split("/").filter(c=>c!==""),t=a(e),i=n?a(n):[];return"/"+i.map((s,c)=>t[c]).join("/")+"/"+r}function d(e,n,r,a){let t=[n,"data-"+n].reduce((i,s)=>{let c=e.getAttribute(s);return r&&e.removeAttribute(s),c===null?i:c},!1);return!a&&t===""?!0:t||a||!1}function L(e){let n=e.split("&").map(r=>r.split("=")).reduce((r,a)=>{let t=a[0];if(!t)return r;let i=a.length>1?a[a.length-1]:!0;return typeof i=="string"&&i.includes(",")&&(i=i.split(",")),r[t]===void 0?r[t]=[i]:r[t].push(i),r},{});return Object.entries(n).reduce((r,a)=>(r[a[0]]=a[1].length>1?a[1]:a[1][0],r),{})}function D(e){return Object.entries(e).map(([n,r])=>r?r===!0?n:`${n}=${Array.isArray(r)?r.join(","):r}`:null).filter(n=>n).join("&")}function H(e,n){return e?n+e:""}function j(e){throw new Error("[Tinro] "+e)}var h={HISTORY:1,HASH:2,MEMORY:3,OFF:4,run(e,n,r,a){return e===this.HISTORY?n&&n():e===this.HASH?r&&r():a&&a()},getDefault(){return!window||window.location.pathname==="srcdoc"?this.MEMORY:this.HISTORY}},O,A,E,b="",u=N();function N(){let e=h.getDefault(),n,r=s=>window.onhashchange=window.onpopstate=O=null,a=s=>n&&n(_(e)),t=s=>{s&&(e=s),r(),e!==h.OFF&&h.run(e,c=>window.onpopstate=a,c=>window.onhashchange=a)&&a()},i=s=>{let c=Object.assign(_(e),s);return c.path+H(D(c.query),"?")+H(c.hash,"#")};return{mode:t,get:s=>_(e),go(s,c){P(e,s,c),a()},start(s){n=s,t()},stop(){n=null,t(h.OFF)},set(s){this.go(i(s),!s.path)},methods(){return Q(this)},base:s=>b=s}}function P(e,n,r){!r&&(A=E);let a=t=>history[`${r?"replace":"push"}State`]({},"",t);h.run(e,t=>a(b+n),t=>a(`#${n}`),t=>O=n)}function _(e){let n=window.location,r=h.run(e,t=>(b?n.pathname.replace(b,""):n.pathname)+n.search+n.hash,t=>String(n.hash.slice(1)||"/"),t=>O||"/"),a=r.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return E=r,{url:r,from:A,path:a[1]||"",query:L(a[2]||""),hash:a[3]||""}}function Q(e){let n=()=>e.get().query,r=s=>e.set({query:s}),a=s=>r(s(n())),t=()=>e.get().hash,i=s=>e.set({hash:s});return{hash:{get:t,set:i,clear:()=>i("")},query:{replace:r,clear:()=>r(""),get(s){return s?n()[s]:n()},set(s,c){a(f=>(f[s]=c,f))},delete(s){a(c=>(c[s]&&delete c[s],c))}}}}var p=U();function U(){let{subscribe:e}=K(u.get(),n=>{u.start(n);let r=B(u.go);return()=>{u.stop(),r()}});return{subscribe:e,goto:u.go,params:G,meta:q,useHashNavigation:n=>u.mode(n?h.HASH:h.HISTORY),mode:{hash:()=>u.mode(h.HASH),history:()=>u.mode(h.HISTORY),memory:()=>u.mode(h.MEMORY)},base:u.base,location:u.methods()}}function Z(e){let n,r,a,t,i=()=>{n=d(e,"href").replace(/^\/#|[?#].*$|\/$/g,""),r=d(e,"exact",!0),a=d(e,"active-class",!0,"active")},s=()=>{let c=v(n,t);c&&(c.exact&&r||!r)?e.classList.add(a):e.classList.remove(a)};return i(),{destroy:p.subscribe(c=>{t=c.path,s()}),update:()=>{i(),s()}}}function B(e){let n=r=>{let a=r.target.closest("a[href]"),t=a&&d(a,"target",!1,"_self"),i=a&&d(a,"tinro-ignore"),s=r.ctrlKey||r.metaKey||r.altKey||r.shiftKey;if(t=="_self"&&!i&&!s&&a){let c=a.getAttribute("href").replace(/^\/#/,"");/^\/\/|^#|^[a-zA-Z]+:/.test(c)||(r.preventDefault(),e(c.startsWith("/")?c:a.href.replace(window.location.origin,"")))}};return addEventListener("click",n),()=>removeEventListener("click",n)}function G(){return I("tinro").meta.params}var g="tinro",et=Y({pattern:"",matched:!0});function M(e){let n=F(g)||et;(n.exact||n.fallback)&&j(`${e.fallback?"<Route fallback>":`<Route path="${e.path}">`}  can't be inside ${n.fallback?"<Route fallback>":`<Route path="${n.path||"/"}"> with exact path`}`);let r=e.fallback?"fallbacks":"childs",a=tt({}),t=Y({fallback:e.fallback,parent:n,update(i){t.exact=!i.path.endsWith("/*"),t.pattern=y(`${t.parent.pattern||""}${i.path}`),t.redirect=i.redirect,t.firstmatch=i.firstmatch,t.breadcrumb=i.breadcrumb,t.match()},register:()=>(t.parent[r].add(t),async()=>{t.parent[r].delete(t),t.parent.activeChilds.delete(t),t.router.un&&t.router.un(),t.parent.match()}),show:()=>{e.onShow(),!t.fallback&&t.parent.activeChilds.add(t)},hide:()=>{e.onHide(),t.parent.activeChilds.delete(t)},match:async()=>{t.matched=!1;let{path:i,url:s,from:c,query:f}=t.router.location,o=v(t.pattern,i);if(!t.fallback&&o&&t.redirect&&(!t.exact||t.exact&&o.exact)){let m=C(i,t.parent.pattern,t.redirect);return p.goto(m,!0)}t.meta=o&&{from:c,url:s,query:f,match:o.part,pattern:t.pattern,breadcrumbs:t.parent.meta&&t.parent.meta.breadcrumbs.slice()||[],params:o.params,subscribe:a.subscribe},t.breadcrumb&&t.meta&&t.meta.breadcrumbs.push({name:t.breadcrumb,path:o.part}),a.set(t.meta),o&&!t.fallback&&(!t.exact||t.exact&&o.exact)&&(!t.parent.firstmatch||!t.parent.matched)?(e.onMeta(t.meta),t.parent.matched=!0,t.show()):t.hide(),o&&t.showFallbacks()}});return V(g,t),X(()=>t.register()),t}function q(){return J(g)?F(g).meta:j("meta() function must be run inside any `<Route>` child component only")}function Y(e){let n={router:{},exact:!1,pattern:null,meta:null,parent:null,fallback:!1,redirect:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,async showFallbacks(){if(!this.fallback&&(await $(),this.childs.size>0&&this.activeChilds.size==0||this.childs.size==0&&this.fallbacks.size>0)){let r=this;for(;r.fallbacks.size==0;)if(r=r.parent,!r)return;r&&r.fallbacks.forEach(a=>{if(a.redirect){let t=C("/",a.parent.pattern,a.redirect);p.goto(t,!0)}else a.show()})}},start(){this.router.un||(this.router.un=p.subscribe(r=>{this.router.location=r,this.pattern!==null&&this.match()}))},match(){this.showFallbacks()}};return Object.assign(n,e),n.start(),n}var dt=e=>({params:e&2,meta:e&4}),W=e=>({params:e[1],meta:e[2]});function z(e){let n,r=e[9].default,a=nt(r,e,e[8],W);return{c(){a&&a.c()},m(t,i){a&&a.m(t,i),n=!0},p(t,i){a&&a.p&&(!n||i&262)&&mt(a,r,t,t[8],n?lt(r,t[8],i,dt):ct(t[8]),W)},i(t){n||(w(a,t),n=!0)},o(t){R(a,t),n=!1},d(t){a&&a.d(t)}}}function pt(e){let n,r,a=e[0]&&z(e);return{c(){a&&a.c(),n=it()},m(t,i){a&&a.m(t,i),ht(t,n,i),r=!0},p(t,[i]){t[0]?a?(a.p(t,i),i&1&&w(a,1)):(a=z(t),a.c(),w(a,1),a.m(n.parentNode,n)):a&&(ot(),R(a,1,1,()=>{a=null}),rt())},i(t){r||(w(a),r=!0)},o(t){R(a),r=!1},d(t){a&&a.d(t),t&&st(n)}}}function bt(e,n,r){let{$$slots:a={},$$scope:t}=n,{path:i="/*"}=n,{fallback:s=!1}=n,{redirect:c=!1}=n,{firstmatch:f=!1}=n,{breadcrumb:o=null}=n,m=!1,x={},k={},T=M({fallback:s,onShow(){r(0,m=!0)},onHide(){r(0,m=!1)},onMeta(l){r(2,k=l),r(1,x=k.params)}});return e.$$set=l=>{"path"in l&&r(3,i=l.path),"fallback"in l&&r(4,s=l.fallback),"redirect"in l&&r(5,c=l.redirect),"firstmatch"in l&&r(6,f=l.firstmatch),"breadcrumb"in l&&r(7,o=l.breadcrumb),"$$scope"in l&&r(8,t=l.$$scope)},e.$$.update=()=>{if(e.$$.dirty&232){t:T.update({path:i,redirect:c,firstmatch:f,breadcrumb:o})}},[m,x,k,i,s,c,f,o,t,a]}var S=class extends at{constructor(n){super(),ut(this,n,bt,pt,ft,{path:3,fallback:4,redirect:5,firstmatch:6,breadcrumb:7})}},gt=S;export{gt as Route,Z as active,q as meta,p as router};
diff --git a/dist/tinro.js b/dist/tinro.js
new file mode 100644
index 0000000000000000000000000000000000000000..60244853e64221b491023d6ee3ffeea50ee6ffbd
--- /dev/null
+++ b/dist/tinro.js
@@ -0,0 +1 @@
+var y=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var Z=(e,a)=>{for(var r in a)y(e,r,{get:a[r],enumerable:!0})},B=(e,a,r,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let t of Q(a))!U.call(e,t)&&t!==r&&y(e,t,{get:()=>a[t],enumerable:!(n=P(a,t))||n.enumerable});return e};var G=e=>B(y({},"__esModule",{value:!0}),e);var lt={};Z(lt,{Route:()=>D,active:()=>W,meta:()=>x,router:()=>p});module.exports=G(lt);var l=require("svelte/internal");var j=require("svelte"),A=require("svelte/store"),m=require("svelte"),z=require("svelte/store");function R(e,a=!1){return e=e.slice(e.startsWith("/#")?2:0,e.endsWith("/*")?-2:void 0),e.startsWith("/")||(e="/"+e),e==="/"&&(e=""),a&&!e.endsWith("/")&&(e+="/"),e}function E(e,a){e=R(e,!0),a=R(a,!0);let r=[],n={},t=!0,i=e.split("/").map(c=>c.startsWith(":")?(r.push(c.slice(1)),"([^\\/]+)"):c).join("\\/"),s=a.match(new RegExp(`^${i}$`));return s||(t=!1,s=a.match(new RegExp(`^${i}`))),s?(r.forEach((c,d)=>n[c]=s[d+1]),{exact:t,params:n,part:s[0].slice(0,-1)}):null}function F(e,a,r){if(r==="")return e;if(r[0]==="/")return r;let n=s=>s.split("/").filter(c=>c!==""),t=n(e),i=a?n(a):[];return"/"+i.map((s,c)=>t[c]).join("/")+"/"+r}function g(e,a,r,n){let t=[a,"data-"+a].reduce((i,s)=>{let c=e.getAttribute(s);return r&&e.removeAttribute(s),c===null?i:c},!1);return!n&&t===""?!0:t||n||!1}function J(e){let a=e.split("&").map(r=>r.split("=")).reduce((r,n)=>{let t=n[0];if(!t)return r;let i=n.length>1?n[n.length-1]:!0;return typeof i=="string"&&i.includes(",")&&(i=i.split(",")),r[t]===void 0?r[t]=[i]:r[t].push(i),r},{});return Object.entries(a).reduce((r,n)=>(r[n[0]]=n[1].length>1?n[1]:n[1][0],r),{})}function V(e){return Object.entries(e).map(([a,r])=>r?r===!0?a:`${a}=${Array.isArray(r)?r.join(","):r}`:null).filter(a=>a).join("&")}function C(e,a){return e?a+e:""}function M(e){throw new Error("[Tinro] "+e)}var f={HISTORY:1,HASH:2,MEMORY:3,OFF:4,run(e,a,r,n){return e===this.HISTORY?a&&a():e===this.HASH?r&&r():n&&n()},getDefault(){return!window||window.location.pathname==="srcdoc"?this.MEMORY:this.HISTORY}},S,q,Y,w="",h=X();function X(){let e=f.getDefault(),a,r=s=>window.onhashchange=window.onpopstate=S=null,n=s=>a&&a(O(e)),t=s=>{s&&(e=s),r(),e!==f.OFF&&f.run(e,c=>window.onpopstate=n,c=>window.onhashchange=n)&&n()},i=s=>{let c=Object.assign(O(e),s);return c.path+C(V(c.query),"?")+C(c.hash,"#")};return{mode:t,get:s=>O(e),go(s,c){$(e,s,c),n()},start(s){a=s,t()},stop(){a=null,t(f.OFF)},set(s){this.go(i(s),!s.path)},methods(){return tt(this)},base:s=>w=s}}function $(e,a,r){!r&&(q=Y);let n=t=>history[`${r?"replace":"push"}State`]({},"",t);f.run(e,t=>n(w+a),t=>n(`#${a}`),t=>S=a)}function O(e){let a=window.location,r=f.run(e,t=>(w?a.pathname.replace(w,""):a.pathname)+a.search+a.hash,t=>String(a.hash.slice(1)||"/"),t=>S||"/"),n=r.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return Y=r,{url:r,from:q,path:n[1]||"",query:J(n[2]||""),hash:n[3]||""}}function tt(e){let a=()=>e.get().query,r=s=>e.set({query:s}),n=s=>r(s(a())),t=()=>e.get().hash,i=s=>e.set({hash:s});return{hash:{get:t,set:i,clear:()=>i("")},query:{replace:r,clear:()=>r(""),get(s){return s?a()[s]:a()},set(s,c){n(d=>(d[s]=c,d))},delete(s){n(c=>(c[s]&&delete c[s],c))}}}}var p=et();function et(){let{subscribe:e}=(0,A.writable)(h.get(),a=>{h.start(a);let r=at(h.go);return()=>{h.stop(),r()}});return{subscribe:e,goto:h.go,params:rt,meta:x,useHashNavigation:a=>h.mode(a?f.HASH:f.HISTORY),mode:{hash:()=>h.mode(f.HASH),history:()=>h.mode(f.HISTORY),memory:()=>h.mode(f.MEMORY)},base:h.base,location:h.methods()}}function W(e){let a,r,n,t,i=()=>{a=g(e,"href").replace(/^\/#|[?#].*$|\/$/g,""),r=g(e,"exact",!0),n=g(e,"active-class",!0,"active")},s=()=>{let c=E(a,t);c&&(c.exact&&r||!r)?e.classList.add(n):e.classList.remove(n)};return i(),{destroy:p.subscribe(c=>{t=c.path,s()}),update:()=>{i(),s()}}}function at(e){let a=r=>{let n=r.target.closest("a[href]"),t=n&&g(n,"target",!1,"_self"),i=n&&g(n,"tinro-ignore"),s=r.ctrlKey||r.metaKey||r.altKey||r.shiftKey;if(t=="_self"&&!i&&!s&&n){let c=n.getAttribute("href").replace(/^\/#/,"");/^\/\/|^#|^[a-zA-Z]+:/.test(c)||(r.preventDefault(),e(c.startsWith("/")?c:n.href.replace(window.location.origin,"")))}};return addEventListener("click",a),()=>removeEventListener("click",a)}function rt(){return(0,j.getContext)("tinro").meta.params}var k="tinro",nt=I({pattern:"",matched:!0});function T(e){let a=(0,m.getContext)(k)||nt;(a.exact||a.fallback)&&M(`${e.fallback?"<Route fallback>":`<Route path="${e.path}">`}  can't be inside ${a.fallback?"<Route fallback>":`<Route path="${a.path||"/"}"> with exact path`}`);let r=e.fallback?"fallbacks":"childs",n=(0,z.writable)({}),t=I({fallback:e.fallback,parent:a,update(i){t.exact=!i.path.endsWith("/*"),t.pattern=R(`${t.parent.pattern||""}${i.path}`),t.redirect=i.redirect,t.firstmatch=i.firstmatch,t.breadcrumb=i.breadcrumb,t.match()},register:()=>(t.parent[r].add(t),async()=>{t.parent[r].delete(t),t.parent.activeChilds.delete(t),t.router.un&&t.router.un(),t.parent.match()}),show:()=>{e.onShow(),!t.fallback&&t.parent.activeChilds.add(t)},hide:()=>{e.onHide(),t.parent.activeChilds.delete(t)},match:async()=>{t.matched=!1;let{path:i,url:s,from:c,query:d}=t.router.location,u=E(t.pattern,i);if(!t.fallback&&u&&t.redirect&&(!t.exact||t.exact&&u.exact)){let b=F(i,t.parent.pattern,t.redirect);return p.goto(b,!0)}t.meta=u&&{from:c,url:s,query:d,match:u.part,pattern:t.pattern,breadcrumbs:t.parent.meta&&t.parent.meta.breadcrumbs.slice()||[],params:u.params,subscribe:n.subscribe},t.breadcrumb&&t.meta&&t.meta.breadcrumbs.push({name:t.breadcrumb,path:u.part}),n.set(t.meta),u&&!t.fallback&&(!t.exact||t.exact&&u.exact)&&(!t.parent.firstmatch||!t.parent.matched)?(e.onMeta(t.meta),t.parent.matched=!0,t.show()):t.hide(),u&&t.showFallbacks()}});return(0,m.setContext)(k,t),(0,m.onMount)(()=>t.register()),t}function x(){return(0,m.hasContext)(k)?(0,m.getContext)(k).meta:M("meta() function must be run inside any `<Route>` child component only")}function I(e){let a={router:{},exact:!1,pattern:null,meta:null,parent:null,fallback:!1,redirect:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,async showFallbacks(){if(!this.fallback&&(await(0,m.tick)(),this.childs.size>0&&this.activeChilds.size==0||this.childs.size==0&&this.fallbacks.size>0)){let r=this;for(;r.fallbacks.size==0;)if(r=r.parent,!r)return;r&&r.fallbacks.forEach(n=>{if(n.redirect){let t=F("/",n.parent.pattern,n.redirect);p.goto(t,!0)}else n.show()})}},start(){this.router.un||(this.router.un=p.subscribe(r=>{this.router.location=r,this.pattern!==null&&this.match()}))},match(){this.showFallbacks()}};return Object.assign(a,e),a.start(),a}var st=e=>({params:e&2,meta:e&4}),K=e=>({params:e[1],meta:e[2]});function L(e){let a,r=e[9].default,n=(0,l.create_slot)(r,e,e[8],K);return{c(){n&&n.c()},m(t,i){n&&n.m(t,i),a=!0},p(t,i){n&&n.p&&(!a||i&262)&&(0,l.update_slot_base)(n,r,t,t[8],a?(0,l.get_slot_changes)(r,t[8],i,st):(0,l.get_all_dirty_from_scope)(t[8]),K)},i(t){a||((0,l.transition_in)(n,t),a=!0)},o(t){(0,l.transition_out)(n,t),a=!1},d(t){n&&n.d(t)}}}function it(e){let a,r,n=e[0]&&L(e);return{c(){n&&n.c(),a=(0,l.empty)()},m(t,i){n&&n.m(t,i),(0,l.insert)(t,a,i),r=!0},p(t,[i]){t[0]?n?(n.p(t,i),i&1&&(0,l.transition_in)(n,1)):(n=L(t),n.c(),(0,l.transition_in)(n,1),n.m(a.parentNode,a)):n&&((0,l.group_outros)(),(0,l.transition_out)(n,1,1,()=>{n=null}),(0,l.check_outros)())},i(t){r||((0,l.transition_in)(n),r=!0)},o(t){(0,l.transition_out)(n),r=!1},d(t){n&&n.d(t),t&&(0,l.detach)(a)}}}function ct(e,a,r){let{$$slots:n={},$$scope:t}=a,{path:i="/*"}=a,{fallback:s=!1}=a,{redirect:c=!1}=a,{firstmatch:d=!1}=a,{breadcrumb:u=null}=a,b=!1,v={},_={},N=T({fallback:s,onShow(){r(0,b=!0)},onHide(){r(0,b=!1)},onMeta(o){r(2,_=o),r(1,v=_.params)}});return e.$$set=o=>{"path"in o&&r(3,i=o.path),"fallback"in o&&r(4,s=o.fallback),"redirect"in o&&r(5,c=o.redirect),"firstmatch"in o&&r(6,d=o.firstmatch),"breadcrumb"in o&&r(7,u=o.breadcrumb),"$$scope"in o&&r(8,t=o.$$scope)},e.$$.update=()=>{if(e.$$.dirty&232){t:N.update({path:i,redirect:c,firstmatch:d,breadcrumb:u})}},[b,v,_,i,s,c,d,u,t,n]}var H=class extends l.SvelteComponent{constructor(a){super(),(0,l.init)(this,a,ct,it,l.safe_not_equal,{path:3,fallback:4,redirect:5,firstmatch:6,breadcrumb:7})}},D=H;
diff --git a/dist/tinro_lib.js b/dist/tinro_lib.js
new file mode 100644
index 0000000000000000000000000000000000000000..81d2ecb19fc1e75d4f78725b69574d2bcae9891c
--- /dev/null
+++ b/dist/tinro_lib.js
@@ -0,0 +1 @@
+import{getContext as C}from"svelte";import{writable as F}from"svelte/store";function p(e,a=!1){return e=e.slice(e.startsWith("/#")?2:0,e.endsWith("/*")?-2:void 0),e.startsWith("/")||(e="/"+e),e==="/"&&(e=""),a&&!e.endsWith("/")&&(e+="/"),e}function d(e,a){e=p(e,!0),a=p(a,!0);let r=[],n={},t=!0,s=e.split("/").map(o=>o.startsWith(":")?(r.push(o.slice(1)),"([^\\/]+)"):o).join("\\/"),c=a.match(new RegExp(`^${s}$`));return c||(t=!1,c=a.match(new RegExp(`^${s}`))),c?(r.forEach((o,h)=>n[o]=c[h+1]),{exact:t,params:n,part:c[0].slice(0,-1)}):null}function x(e,a,r){if(r==="")return e;if(r[0]==="/")return r;let n=c=>c.split("/").filter(o=>o!==""),t=n(e),s=a?n(a):[];return"/"+s.map((c,o)=>t[o]).join("/")+"/"+r}function m(e,a,r,n){let t=[a,"data-"+a].reduce((s,c)=>{let o=e.getAttribute(c);return r&&e.removeAttribute(c),o===null?s:o},!1);return!n&&t===""?!0:t||n||!1}function S(e){let a=e.split("&").map(r=>r.split("=")).reduce((r,n)=>{let t=n[0];if(!t)return r;let s=n.length>1?n[n.length-1]:!0;return typeof s=="string"&&s.includes(",")&&(s=s.split(",")),r[t]===void 0?r[t]=[s]:r[t].push(s),r},{});return Object.entries(a).reduce((r,n)=>(r[n[0]]=n[1].length>1?n[1]:n[1][0],r),{})}function M(e){return Object.entries(e).map(([a,r])=>r?r===!0?a:`${a}=${Array.isArray(r)?r.join(","):r}`:null).filter(a=>a).join("&")}function w(e,a){return e?a+e:""}function k(e){throw new Error("[Tinro] "+e)}var i={HISTORY:1,HASH:2,MEMORY:3,OFF:4,run(e,a,r,n){return e===this.HISTORY?a&&a():e===this.HASH?r&&r():n&&n()},getDefault(){return!window||window.location.pathname==="srcdoc"?this.MEMORY:this.HISTORY}};var y,$,H,b="",l=E();function E(){let e=i.getDefault(),a,r=c=>window.onhashchange=window.onpopstate=y=null,n=c=>a&&a(R(e)),t=c=>{c&&(e=c),r(),e!==i.OFF&&i.run(e,o=>window.onpopstate=n,o=>window.onhashchange=n)&&n()},s=c=>{let o=Object.assign(R(e),c);return o.path+w(M(o.query),"?")+w(o.hash,"#")};return{mode:t,get:c=>R(e),go(c,o){_(e,c,o),n()},start(c){a=c,t()},stop(){a=null,t(i.OFF)},set(c){this.go(s(c),!c.path)},methods(){return j(this)},base:c=>b=c}}function _(e,a,r){!r&&($=H);let n=t=>history[`${r?"replace":"push"}State`]({},"",t);i.run(e,t=>n(b+a),t=>n(`#${a}`),t=>y=a)}function R(e){let a=window.location,r=i.run(e,t=>(b?a.pathname.replace(b,""):a.pathname)+a.search+a.hash,t=>String(a.hash.slice(1)||"/"),t=>y||"/"),n=r.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return H=r,{url:r,from:$,path:n[1]||"",query:S(n[2]||""),hash:n[3]||""}}function j(e){let a=()=>e.get().query,r=c=>e.set({query:c}),n=c=>r(c(a())),t=()=>e.get().hash,s=c=>e.set({hash:c});return{hash:{get:t,set:s,clear:()=>s("")},query:{replace:r,clear:()=>r(""),get(c){return c?a()[c]:a()},set(c,o){n(h=>(h[c]=o,h))},delete(c){n(o=>(o[c]&&delete o[c],o))}}}}var f=T();function T(){let{subscribe:e}=F(l.get(),a=>{l.start(a);let r=P(l.go);return()=>{l.stop(),r()}});return{subscribe:e,goto:l.go,params:Q,meta:O,useHashNavigation:a=>l.mode(a?i.HASH:i.HISTORY),mode:{hash:()=>l.mode(i.HASH),history:()=>l.mode(i.HISTORY),memory:()=>l.mode(i.MEMORY)},base:l.base,location:l.methods()}}function Y(e){let a,r,n,t,s=()=>{a=m(e,"href").replace(/^\/#|[?#].*$|\/$/g,""),r=m(e,"exact",!0),n=m(e,"active-class",!0,"active")},c=()=>{let o=d(a,t);o&&(o.exact&&r||!r)?e.classList.add(n):e.classList.remove(n)};return s(),{destroy:f.subscribe(o=>{t=o.path,c()}),update:()=>{s(),c()}}}function P(e){let a=r=>{let n=r.target.closest("a[href]"),t=n&&m(n,"target",!1,"_self"),s=n&&m(n,"tinro-ignore"),c=r.ctrlKey||r.metaKey||r.altKey||r.shiftKey;if(t=="_self"&&!s&&!c&&n){let o=n.getAttribute("href").replace(/^\/#/,"");/^\/\/|^#|^[a-zA-Z]+:/.test(o)||(r.preventDefault(),e(o.startsWith("/")?o:n.href.replace(window.location.origin,"")))}};return addEventListener("click",a),()=>removeEventListener("click",a)}function Q(){return C("tinro").meta.params}import{hasContext as U,getContext as L,setContext as W,onMount as z,tick as D}from"svelte";import{writable as I}from"svelte/store";var g="tinro",K=v({pattern:"",matched:!0});function q(e){let a=L(g)||K;(a.exact||a.fallback)&&k(`${e.fallback?"<Route fallback>":`<Route path="${e.path}">`}  can't be inside ${a.fallback?"<Route fallback>":`<Route path="${a.path||"/"}"> with exact path`}`);let r=e.fallback?"fallbacks":"childs",n=I({}),t=v({fallback:e.fallback,parent:a,update(s){t.exact=!s.path.endsWith("/*"),t.pattern=p(`${t.parent.pattern||""}${s.path}`),t.redirect=s.redirect,t.firstmatch=s.firstmatch,t.breadcrumb=s.breadcrumb,t.match()},register:()=>(t.parent[r].add(t),async()=>{t.parent[r].delete(t),t.parent.activeChilds.delete(t),t.router.un&&t.router.un(),t.parent.match()}),show:()=>{e.onShow(),!t.fallback&&t.parent.activeChilds.add(t)},hide:()=>{e.onHide(),t.parent.activeChilds.delete(t)},match:async()=>{t.matched=!1;let{path:s,url:c,from:o,query:h}=t.router.location,u=d(t.pattern,s);if(!t.fallback&&u&&t.redirect&&(!t.exact||t.exact&&u.exact)){let A=x(s,t.parent.pattern,t.redirect);return f.goto(A,!0)}t.meta=u&&{from:o,url:c,query:h,match:u.part,pattern:t.pattern,breadcrumbs:t.parent.meta&&t.parent.meta.breadcrumbs.slice()||[],params:u.params,subscribe:n.subscribe},t.breadcrumb&&t.meta&&t.meta.breadcrumbs.push({name:t.breadcrumb,path:u.part}),n.set(t.meta),u&&!t.fallback&&(!t.exact||t.exact&&u.exact)&&(!t.parent.firstmatch||!t.parent.matched)?(e.onMeta(t.meta),t.parent.matched=!0,t.show()):t.hide(),u&&t.showFallbacks()}});return W(g,t),z(()=>t.register()),t}function O(){return U(g)?L(g).meta:k("meta() function must be run inside any `<Route>` child component only")}function v(e){let a={router:{},exact:!1,pattern:null,meta:null,parent:null,fallback:!1,redirect:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,async showFallbacks(){if(!this.fallback&&(await D(),this.childs.size>0&&this.activeChilds.size==0||this.childs.size==0&&this.fallbacks.size>0)){let r=this;for(;r.fallbacks.size==0;)if(r=r.parent,!r)return;r&&r.fallbacks.forEach(n=>{if(n.redirect){let t=x("/",n.parent.pattern,n.redirect);f.goto(t,!0)}else n.show()})}},start(){this.router.un||(this.router.un=f.subscribe(r=>{this.router.location=r,this.pattern!==null&&this.match()}))},match(){this.showFallbacks()}};return Object.assign(a,e),a.start(),a}export{Y as active,q as createRouteObject,O as meta,f as router};
diff --git a/index.d.ts b/index.d.ts
index a7c655a733792c5b15b7aea49a8ba929c39cc736..d70a72b1a3d51c7f35df60c08ac9296ad2c77cda 100644
--- a/index.d.ts
+++ b/index.d.ts
@@ -1,3 +1,5 @@
+import { SvelteComponentTyped } from "svelte";
+
 interface TinroRoute {
   url: string;
   from: string;
@@ -41,18 +43,18 @@ interface TinroRouterLocationHash {
 }
 
 interface TinroRouterLocationQuery {
-  /** Get the value by property name */ 
-  get(name:string): string | undefined
-  /** Get the query object */ 
-  get(): Record<string, string>
-  /** Update or add a property in the query object */ 
-  set(name:string,value:string|number): void
-  /** Delete a property from the query object */ 
-  delete(name:string): void
-  /** Replace value of the query object */ 
-  replace(value: Record<string, string>): void
-  /** Clear the query object */ 
-  clear(): void
+  /** Get the value by property name */
+  get(name: string): string | undefined;
+  /** Get the query object */
+  get(): Record<string, string>;
+  /** Update or add a property in the query object */
+  set(name: string, value: string | number): void;
+  /** Delete a property from the query object */
+  delete(name: string): void;
+  /** Replace value of the query object */
+  replace(value: Record<string, string>): void;
+  /** Clear the query object */
+  clear(): void;
 }
 
 interface TinroRouterLocation {
@@ -83,8 +85,8 @@ declare interface TinroRouter {
 export const active: any;
 export function meta(): TinroRouteMeta;
 export const router: TinroRouter;
-export class Route {
-  $$prop_def: {
+export class Route extends SvelteComponentTyped<
+  {
     /**
      * Exact o relative path of the route
      * @default "/*"
@@ -113,14 +115,14 @@ export class Route {
      * @default null
      */
     breadcrumb?: string;
-  };
-
-  $$slot_def: {
+  },
+  {},
+  {
     default: {
       /** Current meta for the route */
       meta: TinroRouteMeta;
       /** @deprecated Use meta.params instead */
       params: Record<string, string>;
     };
-  };
-}
+  }
+> {}
